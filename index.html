
<!DOCTYPE html>
<html lang="en">
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link href="stylenav.css" rel="stylesheet" type="text/css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

  <title>Survey Bayesian Networks</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  
</head>

<body>

<!-- Navigation bar -->
<nav class="navbar navbar-default navbar-fixed-top navbar-customclass">
  <div class="container">
    <div class="navbar-header">
      <a class="navbar-brand" href="/template.html" style="color: #BC2F31"><strong>Survey</strong></a>

      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      <sapn class="icon-bar"></sapn>
      </button>
    </div>
    <ul class="nav navbar-nav navbar-right collapse navbar-collapse">
      <li class="active"><a href="#info">Information</a></li>
	      <li><a href="#consent">Consent Form</a></li>
      <li><a href="#q1">Q1</a></li>
		<li><a href="#q2">Q2</a></li>
		<li><a href="#q3">Q3</a></li>
		<li><a href="#q4">Q4</a></li>
    </ul>
  </div>
</nav>

<div class="jumbotron text-center">
<h1>Survey on Bayesian Networks</h1>
</div>

<div class="container">
  <div class="row">
	  <h1 id="info">Participants Information</h1>
	  
	 <h4>
Thank you for helping us test our Bayesian Network explainer system.

<br>Here you will see a Bayesian Network, some evidence and an explained output.

<br>The Bayesian Network we will be using as an example is used for medical diagnosis. 
<br>In particular, it is used to determine the chances that a patient has lung cancer, given their symptoms, risk factors and medical history.
 </h4>
	  
	</div>
	<hr>
	
	<div class="row"> 	  
  <h1 id="consent">Consent Form</h1> 
  
  <!-- Libraries for SurveyJS -->
<link href="https://unpkg.com/survey-jquery@1.8.60/modern.css" type="text/css" rel="stylesheet" />
<script src="https://unpkg.com/survey-jquery@1.8.60/survey.jquery.min.js"></script>

<!-- Form container -->
<div id="consentFormContainer"></div>
  
<script>
Survey.StylesManager.applyTheme("modern");

var surveyJSON = { surveyId: '67a2625c-4cef-4342-a966-74432c5cb3e8', 
                   surveyPostId: '38fc3d75-8b29-4c2d-ad2e-d84aed291ba5'}

var survey = new Survey.Model(surveyJSON);
$("#consentFormContainer").Survey({
    model: survey,
});
</script>

  
	</div>
  
	 <div class="row">
	  
	  
	 <p class="textbig">

<br>Here you will see a Bayesian Network, some evidence and an explained output.

<br>The Bayesian Network we will be using as an example is used for medical diagnosis. 
<br>In particular, it is used to determine the chances that a patient has lung cancer, given their symptoms, risk factors and medical history.
 </p>
	
  
	

  <!-- Bayesian Network graph -->
	<img src="/static/graph.png" />
	</div>
	 <hr> 
   
  <table border="1" class="dataframe data">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>smoke</td>
      <td>Whether the patient smokes</td>
    </tr>
    <tr>
      <th>1</th>
      <td>asia</td>
      <td>Whether the patient has recently been to Asia</td>
    </tr>
    <tr>
      <th>2</th>
      <td>lung</td>
      <td>Whether the patient has lung cancer</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bronc</td>
      <td>Whether the patient has bronchitis</td>
    </tr>
    <tr>
      <th>4</th>
      <td>tub</td>
      <td>Whether the patient has tuberculosis</td>
    </tr>
    <tr>
      <th>5</th>
      <td>lung_disease</td>
      <td>True if the patient has either lung cancer or tuberculosis</td>
    </tr>
    <tr>
      <th>6</th>
      <td>xray</td>
      <td>Whether the patient's xray results show an abnormality</td>
    </tr>
    <tr>
      <th>7</th>
      <td>dysp</td>
      <td>Whether the patient experiences shortness of breath (dyspnea)</td>
    </tr>
  </tbody>
</table>
	 
  <h1 id="q1">Treatment no mistake</h1>
  
  <div>
  
  <p> We have observed that: </p>
  
  <ul>
  
    <li>the patient has tuberculosis</li>
  
    <li>the patient does not experience shortness of breath</li>
  
    <li>the patient does not smoke</li>
  
  </ul>
</div>
  
  <style>
/* Style the tab */
.tab {
  overflow: hidden;
  border: 1px solid #ccc;
  background-color: #f1f1f1;
}

/* Style the buttons that are used to open the tab content */
.tab button {
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
}

/* Change background color of buttons on hover */
.tab button:hover {
  background-color: #ddd;
}

/* Create an active/current tablink class */
.tab button.active {
  background-color: #ccc;
}

/* Style the tab content */
.tabcontent {
  display: none;
  padding: 6px 12px;
  border: 1px solid #ccc;
  border-top: none;
}
</style>

<script>
function openTab(evt, tabName) {
  // Declare all variables
  var i, tabcontent, tablinks;

  // Get all elements with class="tabcontent" and hide them
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }

  // Get all elements with class="tablinks" and remove the class "active"
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }

  // Show the current tab, and add an "active" class to the button that opened the tab
  document.getElementById(tabName).style.display = "block";
  evt.currentTarget.className += " active";
}
</script>

<div class="tab">

  <button class="tablinks" onclick="openTab(event, 'explanation_treatment_no_mistake_0')" id="explanation_treatment_no_mistake_button_0">
    0
  </button>

  <button class="tablinks" onclick="openTab(event, 'explanation_treatment_no_mistake_1')" id="explanation_treatment_no_mistake_button_1">
    1
  </button>

  <button class="tablinks" onclick="openTab(event, 'explanation_treatment_no_mistake_2')" id="explanation_treatment_no_mistake_button_2">
    2
  </button>

  <button class="tablinks" onclick="openTab(event, 'explanation_treatment_no_mistake_3')" id="explanation_treatment_no_mistake_button_3">
    3
  </button>

</div>



  <div id="explanation_treatment_no_mistake_0", class="tabcontent">
  <p>
  
     The baseline probability that the patient has lung cancer is 5.50% 
  
  </p> <hr>
  <img src="/static/io_no_mistake_0.png" />
  </div>

  <div id="explanation_treatment_no_mistake_1", class="tabcontent">
  <p>
  
     We have observed that the patient does not smoke 
  
     this greatly decreases the likelihood that the patient has lung cancer 
  
     This consideration changes the probability that the patient has lung cancer from 5.50% to 1.00% 
  
  </p> <hr>
  <img src="/static/graph_1.png" />
  </div>

  <div id="explanation_treatment_no_mistake_2", class="tabcontent">
  <p>
  
     We have observed that the patient does not smoke 
  
     this moderately decreases the likelihood that the patient has bronchitis 
  
     on the other hand, we have observed that the patient does not experience shortness of breath 
  
     this greatly increases the likelihood that the patient does not have a serious lung disease 
  
     this moderately decreases the likelihood that the patient has lung cancer 
  
     This consideration changes the probability that the patient has lung cancer from 1.00% to 0.52% 
  
  </p> <hr>
  <img src="/static/graph_2.png" />
  </div>

  <div id="explanation_treatment_no_mistake_3", class="tabcontent">
  <p>
  
     After taking into account these 3 arguments, we conclude that the probability that the patient has lung cancer is 0.52% 
  
  </p> <hr>
  <img src="/static/graph_3.png" />
  </div>


<script>
// Get the element with id="button 0" and click on it
document.getElementById("explanation_treatment_no_mistake_button_0").click();
</script>
  
  
<link href="https://unpkg.com/survey-jquery@1.8.60/modern.css" type="text/css" rel="stylesheet" />
<script src="https://unpkg.com/survey-jquery@1.8.60/survey.jquery.min.js"></script>

<!-- SurveyJS container -->
<div id="surveyContainer_survey_treatment_no_mistake"></div>

<!-- Script that fetches and submits the survey -->
<script>
Survey.StylesManager.applyTheme("modern");

function sendDataToServer_survey_treatment_no_mistake(survey) {
  survey.setValue("bn", "asia")
  survey.setValue("p", 0.005218071612272695)
  survey.setValue("is_treatment", true)
  survey.setValue("mistake", "no mistake")
  survey.sendResult('2fd3f481-70d1-4b40-ab8b-611d89238ad5');
}

var surveyJSON = { surveyId: 'b48b6122-d333-462a-bd57-34ca878560e7', 
                   surveyPostId: '2fd3f481-70d1-4b40-ab8b-611d89238ad5'}

var survey_survey_treatment_no_mistake = new Survey.Model(surveyJSON);

$("#surveyContainer_survey_treatment_no_mistake").Survey({
    model: survey_survey_treatment_no_mistake,
    onComplete: sendDataToServer_survey_treatment_no_mistake
});
</script>
  
  
  <h1 id="q2">Control no mistake</h1>
  
  <div>
  
  <p> We have observed that: </p>
  
  <ul>
  
    <li>the patient does not have bronchitis</li>
  
    <li>the patient experiences shortness of breath</li>
  
    <li>the patient has not recently visited Asia</li>
  
    <li>the patient&#39;s xray results show an abnormality</li>
  
    <li>the patient does not smoke</li>
  
  </ul>
</div>
  
  <!-- Libraries for JSBayes-viz -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script src="/static/node_modules/d3/d3.js"></script>
<script src="/static/node_modules/lodash/lodash.js"></script>
<script src="/static/node_modules/graphlib/dist/graphlib.core.js"></script>
<script src="/static/node_modules/dagre/dist/dagre.core.js"></script>
<script src="/static/node_modules/jsbayes/jsbayes.js"></script>
<script src="/static/node_modules/jsbayes-viz/jsbayes-viz.js"></script>

<style>
    svg { border: 1px solid black; }
    svg g rect.node-shape { border-radius: 5px !important; fill:#cceeff !important; cursor: move; }
    svg g text.node-name { font-weight: 800 !important }
    svg g rect.node-bar { fill: DodgerBlue !important }
    svg g text.node-value { fill:rgb(0,0,0) !important; font-size: 15px; cursor: pointer; }
    svg line.edge-line { stroke:rgb(0,0,0) !important }
    svg path.edge-head { fill:rgb(0,0,0) !important }
</style>

<script>
  function getGraph_explanation_control_no_mistake() {
    
    var graph = jsbayes.newGraph();
    graph.saveSamples = false;
    
    <!-- Add nodes to graph -->
    
    var asia = graph.addNode( 'asia', [ 'yes',   'no',  ]);
    
    var tub = graph.addNode( 'tub', [ 'yes',   'no',  ]);
    
    var smoke = graph.addNode( 'smoke', [ 'yes',   'no',  ]);
    
    var lung = graph.addNode( 'lung', [ 'yes',   'no',  ]);
    
    var bronc = graph.addNode( 'bronc', [ 'yes',   'no',  ]);
    
    var lung_disease = graph.addNode( 'lung_disease', [ 'yes',   'no',  ]);
    
    var xray = graph.addNode( 'xray', [ 'abnormal',   'normal',  ]);
    
    var dysp = graph.addNode( 'dysp', [ 'yes',   'no',  ]);
    
    
    <!-- Add edges to graph -->
    
    tub.addParent(asia);
    
    lung_disease.addParent(tub);
    
    lung.addParent(smoke);
    
    bronc.addParent(smoke);
    
    lung_disease.addParent(lung);
    
    dysp.addParent(bronc);
    
    xray.addParent(lung_disease);
    
    dysp.addParent(lung_disease);
    
    
    <!-- Add CPDs to graph -->
    
    asia.setCpt([0.01, 0.99]);
    
    tub.setCpt([[0.05, 0.95], [0.01, 0.99]]);
    
    smoke.setCpt([0.5, 0.5]);
    
    lung.setCpt([[0.1, 0.9], [0.01, 0.99]]);
    
    bronc.setCpt([[0.6, 0.4], [0.3, 0.7]]);
    
    lung_disease.setCpt([[1.0, 0.0], [1.0, 0.0], [1.0, 0.0], [0.0, 1.0]]);
    
    xray.setCpt([[0.98, 0.02], [0.05, 0.95]]);
    
    dysp.setCpt([[0.9, 0.1], [0.7, 0.3], [0.8, 0.2], [0.1, 0.9]]);
    

    graph.sample(20000);

    var g = jsbayesviz.fromGraph(graph);
    return g;
  }
      
  $(document).ready(function() {
    (function(window) { 
      var graph_explanation_control_no_mistake = getGraph_explanation_control_no_mistake();
      jsbayesviz.draw({
        id: '#explanation_control_no_mistake',
        width: 800,
        height: 800,
        graph: graph_explanation_control_no_mistake,
        samples: 15000
      });
      
      
    })(window);
  });
</script>

<svg id="explanation_control_no_mistake"></svg>
  
  
<link href="https://unpkg.com/survey-jquery@1.8.60/modern.css" type="text/css" rel="stylesheet" />
<script src="https://unpkg.com/survey-jquery@1.8.60/survey.jquery.min.js"></script>

<!-- SurveyJS container -->
<div id="surveyContainer_survey_control_no_mistake"></div>

<!-- Script that fetches and submits the survey -->
<script>
Survey.StylesManager.applyTheme("modern");

function sendDataToServer_survey_control_no_mistake(survey) {
  survey.setValue("bn", "asia")
  survey.setValue("p", 0.36977344638554543)
  survey.setValue("is_treatment", false)
  survey.setValue("mistake", "no mistake")
  survey.sendResult('2fd3f481-70d1-4b40-ab8b-611d89238ad5');
}

var surveyJSON = { surveyId: 'b48b6122-d333-462a-bd57-34ca878560e7', 
                   surveyPostId: '2fd3f481-70d1-4b40-ab8b-611d89238ad5'}

var survey_survey_control_no_mistake = new Survey.Model(surveyJSON);

$("#surveyContainer_survey_control_no_mistake").Survey({
    model: survey_survey_control_no_mistake,
    onComplete: sendDataToServer_survey_control_no_mistake
});
</script>
  
  
  <h1 id="q3">Treatment mistake</h1>
  
  <div>
  
  <p> We have observed that: </p>
  
  <ul>
  
    <li>the patient has not recently visited Asia</li>
  
  </ul>
</div>
  
  <style>
/* Style the tab */
.tab {
  overflow: hidden;
  border: 1px solid #ccc;
  background-color: #f1f1f1;
}

/* Style the buttons that are used to open the tab content */
.tab button {
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
}

/* Change background color of buttons on hover */
.tab button:hover {
  background-color: #ddd;
}

/* Create an active/current tablink class */
.tab button.active {
  background-color: #ccc;
}

/* Style the tab content */
.tabcontent {
  display: none;
  padding: 6px 12px;
  border: 1px solid #ccc;
  border-top: none;
}
</style>

<script>
function openTab(evt, tabName) {
  // Declare all variables
  var i, tabcontent, tablinks;

  // Get all elements with class="tabcontent" and hide them
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }

  // Get all elements with class="tablinks" and remove the class "active"
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }

  // Show the current tab, and add an "active" class to the button that opened the tab
  document.getElementById(tabName).style.display = "block";
  evt.currentTarget.className += " active";
}
</script>

<div class="tab">

  <button class="tablinks" onclick="openTab(event, 'explanation_treatment_mistake_0')" id="explanation_treatment_mistake_button_0">
    0
  </button>

  <button class="tablinks" onclick="openTab(event, 'explanation_treatment_mistake_1')" id="explanation_treatment_mistake_button_1">
    1
  </button>

</div>



  <div id="explanation_treatment_mistake_0", class="tabcontent">
  <p>
  
     The baseline probability that the patient has lung cancer is 5.50% 
  
  </p> <hr>
  <img src="/static/io_mistake_0.png" />
  </div>

  <div id="explanation_treatment_mistake_1", class="tabcontent">
  <p>
  
     After taking into account these 1 arguments, we conclude that the probability that the patient has lung cancer is 5.50% 
  
  </p> <hr>
  <img src="/static/graph_1.png" />
  </div>


<script>
// Get the element with id="button 0" and click on it
document.getElementById("explanation_treatment_mistake_button_0").click();
</script>
  
  
<link href="https://unpkg.com/survey-jquery@1.8.60/modern.css" type="text/css" rel="stylesheet" />
<script src="https://unpkg.com/survey-jquery@1.8.60/survey.jquery.min.js"></script>

<!-- SurveyJS container -->
<div id="surveyContainer_survey_treatment_mistake"></div>

<!-- Script that fetches and submits the survey -->
<script>
Survey.StylesManager.applyTheme("modern");

function sendDataToServer_survey_treatment_mistake(survey) {
  survey.setValue("bn", "asia")
  survey.setValue("p", 0.05499999999999999)
  survey.setValue("is_treatment", true)
  survey.setValue("mistake", "dysp")
  survey.sendResult('2fd3f481-70d1-4b40-ab8b-611d89238ad5');
}

var surveyJSON = { surveyId: 'b48b6122-d333-462a-bd57-34ca878560e7', 
                   surveyPostId: '2fd3f481-70d1-4b40-ab8b-611d89238ad5'}

var survey_survey_treatment_mistake = new Survey.Model(surveyJSON);

$("#surveyContainer_survey_treatment_mistake").Survey({
    model: survey_survey_treatment_mistake,
    onComplete: sendDataToServer_survey_treatment_mistake
});
</script>
  
  <h1 id="q4">Control mistake</h1>
  
  <div>
  
  <p> We have observed that: </p>
  
  <ul>
  
    <li>the patient has not recently visited Asia</li>
  
    <li>the patient&#39;s xray results are normal</li>
  
    <li>the patient does not smoke</li>
  
  </ul>
</div>
  
  <!-- Libraries for JSBayes-viz -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script src="/static/node_modules/d3/d3.js"></script>
<script src="/static/node_modules/lodash/lodash.js"></script>
<script src="/static/node_modules/graphlib/dist/graphlib.core.js"></script>
<script src="/static/node_modules/dagre/dist/dagre.core.js"></script>
<script src="/static/node_modules/jsbayes/jsbayes.js"></script>
<script src="/static/node_modules/jsbayes-viz/jsbayes-viz.js"></script>

<style>
    svg { border: 1px solid black; }
    svg g rect.node-shape { border-radius: 5px !important; fill:#cceeff !important; cursor: move; }
    svg g text.node-name { font-weight: 800 !important }
    svg g rect.node-bar { fill: DodgerBlue !important }
    svg g text.node-value { fill:rgb(0,0,0) !important; font-size: 15px; cursor: pointer; }
    svg line.edge-line { stroke:rgb(0,0,0) !important }
    svg path.edge-head { fill:rgb(0,0,0) !important }
</style>

<script>
  function getGraph_explanation_control_mistake() {
    
    var graph = jsbayes.newGraph();
    graph.saveSamples = false;
    
    <!-- Add nodes to graph -->
    
    var asia = graph.addNode( 'asia', [ 'yes',   'no',  ]);
    
    var tub = graph.addNode( 'tub', [ 'yes',   'no',  ]);
    
    var smoke = graph.addNode( 'smoke', [ 'yes',   'no',  ]);
    
    var lung = graph.addNode( 'lung', [ 'yes',   'no',  ]);
    
    var bronc = graph.addNode( 'bronc', [ 'yes',   'no',  ]);
    
    var lung_disease = graph.addNode( 'lung_disease', [ 'yes',   'no',  ]);
    
    var xray = graph.addNode( 'xray', [ 'abnormal',   'normal',  ]);
    
    var dysp = graph.addNode( 'dysp', [ 'yes',   'no',  ]);
    
    
    <!-- Add edges to graph -->
    
    tub.addParent(asia);
    
    lung_disease.addParent(tub);
    
    lung.addParent(smoke);
    
    bronc.addParent(smoke);
    
    lung_disease.addParent(lung);
    
    dysp.addParent(bronc);
    
    xray.addParent(lung_disease);
    
    dysp.addParent(lung_disease);
    
    
    <!-- Add CPDs to graph -->
    
    asia.setCpt([0.01, 0.99]);
    
    tub.setCpt([[0.05, 0.95], [0.01, 0.99]]);
    
    smoke.setCpt([0.5, 0.5]);
    
    lung.setCpt([[0.1, 0.9], [0.01, 0.99]]);
    
    bronc.setCpt([[0.6, 0.4], [0.3, 0.7]]);
    
    lung_disease.setCpt([[1.0, 0.0], [1.0, 0.0], [1.0, 0.0], [0.0, 1.0]]);
    
    xray.setCpt([[0.98, 0.02], [0.05, 0.95]]);
    
    dysp.setCpt([[0.9, 0.1], [0.7, 0.3], [0.8, 0.2], [0.1, 0.9]]);
    

    graph.sample(20000);

    var g = jsbayesviz.fromGraph(graph);
    return g;
  }
      
  $(document).ready(function() {
    (function(window) { 
      var graph_explanation_control_mistake = getGraph_explanation_control_mistake();
      jsbayesviz.draw({
        id: '#explanation_control_mistake',
        width: 800,
        height: 800,
        graph: graph_explanation_control_mistake,
        samples: 15000
      });
      
      
    })(window);
  });
</script>

<svg id="explanation_control_mistake"></svg>
  
  
<link href="https://unpkg.com/survey-jquery@1.8.60/modern.css" type="text/css" rel="stylesheet" />
<script src="https://unpkg.com/survey-jquery@1.8.60/survey.jquery.min.js"></script>

<!-- SurveyJS container -->
<div id="surveyContainer_survey_control_mistake"></div>

<!-- Script that fetches and submits the survey -->
<script>
Survey.StylesManager.applyTheme("modern");

function sendDataToServer_survey_control_mistake(survey) {
  survey.setValue("bn", "asia")
  survey.setValue("p", 0.6779196767898106)
  survey.setValue("is_treatment", false)
  survey.setValue("mistake", "lung")
  survey.sendResult('2fd3f481-70d1-4b40-ab8b-611d89238ad5');
}

var surveyJSON = { surveyId: 'b48b6122-d333-462a-bd57-34ca878560e7', 
                   surveyPostId: '2fd3f481-70d1-4b40-ab8b-611d89238ad5'}

var survey_survey_control_mistake = new Survey.Model(surveyJSON);

$("#surveyContainer_survey_control_mistake").Survey({
    model: survey_survey_control_mistake,
    onComplete: sendDataToServer_survey_control_mistake
});
</script>
   
  
  
  </div>
</div>   
    
</body>
</html>